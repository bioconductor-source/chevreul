<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="chevreul">
<title>Visualization • chevreul</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Visualization">
<meta property="og:description" content="chevreul">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">chevreul</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.4.12</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/integration.html">Integration of Seurat objects</a>
    <a class="dropdown-item" href="../articles/preprocessing.html">Preprocessing</a>
    <a class="dropdown-item" href="../articles/shiny_app.html">Shiny App</a>
    <a class="dropdown-item" href="../articles/visualization.html">Visualization</a>
    <a class="dropdown-item" href="../articles/getting-started.html">Getting Started</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/cobriniklab/chevreul/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Visualization</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/cobriniklab/chevreul/blob/HEAD/vignettes/articles/visualization.Rmd" class="external-link"><code>vignettes/articles/visualization.Rmd</code></a></small>
      <div class="d-none name"><code>visualization.Rmd</code></div>
    </div>

    
    
<p>This article demonstrates data visualization tools present in
Chevreul. Through this article we will be introducing differnt
visualization functions, their workings, and the resulting plots
produced by these functions.</p>
<p>First set is to load Chevreul anf all other packages required</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/cobriniklab/chevreul" class="external-link">chevreul</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://satijalab.org/seurat" class="external-link">Seurat</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggraph.data-imaginist.com" class="external-link">ggraph</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com" class="external-link">patchwork</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="tldr">TLDR<a class="anchor" aria-label="anchor" href="#tldr"></a>
</h3>
<p>chevreul provides a single command to:</p>
<ul>
<li><p>construct a Seurat object</p></li>
<li><p>filter genes by minimum expression and ubiquity</p></li>
<li><p>normalize and scale expression by any of several methods packaged
in Seurat</p></li>
</ul>
</div>
<div class="section level2">
<h2 id="run-clustering-on-a-single-seurat-object">Run clustering on a single seurat object<a class="anchor" aria-label="anchor" href="#run-clustering-on-a-single-seurat-object"></a>
</h2>
<p>By default clustering will be run at ten different resolutions
between 0.2 and 2.0. Any resolution can be specified by providing the
resolution argument as a numeric vector.</p>
<div class="section level3">
<h3 id="basic">Basic<a class="anchor" aria-label="anchor" href="#basic"></a>
</h3>
</div>
</div>
<div class="section level2">
<h2 id="plotting-features-using-chevreul">Plotting features using Chevreul<a class="anchor" aria-label="anchor" href="#plotting-features-using-chevreul"></a>
</h2>
<p>Chevreul contains a function that plots a vector of one or more
features, either gene or transcript expression, overlaid on a given
embedding. This function results in a interactive, single or
multi-feature plot</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_feature.html">plot_feature</a></span><span class="op">(</span><span class="va">clustered_seu</span>, embedding <span class="op">=</span> <span class="st">"umap"</span>, features <span class="op">=</span> <span class="st">"RXRG"</span>, return_plotly <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="visualization_files/figure-html/unnamed-chunk-3-1.png" width="100%"></p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span> <span class="fu"><a href="../reference/plot_feature.html">plot_feature</a></span><span class="op">(</span><span class="va">clustered_seu</span>, embedding <span class="op">=</span> <span class="st">"umap"</span>, features <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"RXRG"</span>, <span class="st">"NRL"</span><span class="op">)</span>, return_plotly <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> </span></code></pre></div>
<p><img src="visualization_files/figure-html/unnamed-chunk-4-1.png" width="100%"></p>
<p>This Chevreul function includes multiple sub-functions that
ultimately helps in creation of an interactive feature plot. When
plotting only one feature, an existing Seurat function, FeaturePlot() is
used. This function colors single cells on a dimensional reduction plot
according to a ‘feature’. If multiple features are to be plotted, the
joint density of all the features are plotted using a plot_density()
function from the Nebulosa package. Once a feature plot of produced,
this plot can be converted to an interactive plot using return_plotly =
TRUE argument within the plot_feature() function</p>
</div>
<div class="section level2">
<h2 id="plotting-cluster-marker-genes-plot_markers">Plotting cluster marker genes: plot_markers<a class="anchor" aria-label="anchor" href="#plotting-cluster-marker-genes-plot_markers"></a>
</h2>
<p>Chevreul contains a function to create a dot plot of N number of
marker features that are grouped by user specified cell metadata. The
features are grouped by wilcoxon rank-sum test implemented in
presto.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_markers.html">plot_markers</a></span><span class="op">(</span><span class="va">clustered_seu</span>, metavar <span class="op">=</span> <span class="st">"gene_snn_res.0.2"</span>, marker_method <span class="op">=</span> <span class="st">"presto"</span>, return_plotly <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="visualization_files/figure-html/unnamed-chunk-5-1.png" width="100%"></p>
<p>In this Chevreul function, metadata variable from which to pick
clusters is provided by the user through the argument metavar. From this
metavar, cells are grouped based on presence of N number of marker
features using wilcoxon rank sum test. In the resulting dot plot the
sixe of the dot corresponds to the percentage of cells expressing the
feature in each cluster and the color represents the average expression
level of the feature.</p>
</div>
<div class="section level2">
<h2 id="plot-read-count-using-plot_readcount">Plot read count using plot_readcount()<a class="anchor" aria-label="anchor" href="#plot-read-count-using-plot_readcount"></a>
</h2>
<p>The plot_readcount function in Chevreul plots a bar plot of number of
read counts present in a metadata variable for each sample in the Seurat
object. Here, the bars of the plot can be colored based on categorical
metadata variable using the argument color.by whose default value is set
to “batch”</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_readcount.html">plot_readcount</a></span><span class="op">(</span><span class="va">clustered_seu</span>, metavar <span class="op">=</span> <span class="st">"nCount_RNA"</span>, color.by <span class="op">=</span> <span class="st">"dataset"</span>, return_plotly <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="visualization_files/figure-html/unnamed-chunk-6-1.png" width="100%"></p>
</div>
<div class="section level2">
<h2 id="plot-metadata-vriable-using-plot_var">Plot Metadata Vriable using plot_var()<a class="anchor" aria-label="anchor" href="#plot-metadata-vriable-using-plot_var"></a>
</h2>
<p>Chevreul contains a function that produces a scatter plot of metadata
variable, where each point in the plot represents a cell whose position
on the plot is given by the cell embedding determined by the dimensional
reduction technique. The default dimensionality reduction used is
“umap”. The group argument in plot_var() function allows the user to
enter the metadata variable by which to group the cells by, its default
value is set to “batch”</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_var.html">plot_var</a></span><span class="op">(</span><span class="va">clustered_seu</span>, group <span class="op">=</span> <span class="st">"celltype"</span>, embedding <span class="op">=</span> <span class="st">"umap"</span>, return_plotly <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="visualization_files/figure-html/unnamed-chunk-7-1.png" width="100%">
This function contains a Seurat DimPlot() function as sub function which
prduces the dimensional reduction plot</p>
</div>
<div class="section level2">
<h2 id="plot_violin">plot_violin<a class="anchor" aria-label="anchor" href="#plot_violin"></a>
</h2>
<div class="section level3">
<h3 id="intermediate">intermediate<a class="anchor" aria-label="anchor" href="#intermediate"></a>
</h3>
<p>plot_all_transcripts plot_transcript_composition</p>
</div>
<div class="section level3">
<h3 id="complicated">complicated<a class="anchor" aria-label="anchor" href="#complicated"></a>
</h3>
<p>cross_plot_vars plot_multiple_branches_heatmap plot_ridge
seu_complex_heatmap</p>
</div>
</div>
<div class="section level2">
<h2 id="section-about-plotly">section about plotly<a class="anchor" aria-label="anchor" href="#section-about-plotly"></a>
</h2>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Kevin Stachelek.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
